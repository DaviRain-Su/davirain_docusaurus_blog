# 网络和区块链

在考虑构建区块链时，考虑边界是定义网络的要素是很有用的。例如，可以将连接到单个路由器的一组计算机视为家庭网络。防火墙可能是定义企业网络的边界。较小的、孤立的网络可以通过通用的通信协议连接到更广的区域网络。同样，您可以将区块链网络视为由其边界及其与其他区块链的隔离或通信定义。

作为区块链构建者的工具包，Substrate 使您能够开发您可以想象的任何类型的区块链，并根据您的应用程序特定要求定义其边界。考虑到这种灵活性，您需要做出的决定之一是您要构建的网络类型以及不同节点在该网络中可能扮演的角色。

## 网络类型
基于基底的区块链可用于不同类型的网络架构。例如，Substrate 区块链用于构建以下网络类型：

- 限制对一组受限节点的访问的专用网络。
- 实现自己的安全协议并且不与任何其他链连接或通信的单链。比特币和以太坊是非基于 Substrate 的单链的例子。
- 中继链为连接到它们的其他链提供分散的安全性和通信。Kusama 和 Polkadot 是中继链的例子。
- 为连接到中继链而构建的平行链，并能够与使用相同中继链的其他链进行通信。由于平行链依赖中继链来最终确定生成的区块，因此平行链必须实施与它们所针对的中继链相同的共识协议。

## 节点类型
区块链需要同步网络节点以呈现区块链状态的一致和最新视图。每个同步节点都存储区块链的副本并跟踪传入的交易。但是，保留整个区块链的完整副本需要大量存储和计算资源，并且对于大多数用例而言，下载从创世到最新的所有区块并不实用。为了更容易维护链的安全性和完整性，同时减少想要访问区块链数据的客户端的资源需求，有不同类型的节点可以与链交互：

- 全节点
- 存档节点
- 轻客户端节点

### 全节点
全节点是区块链网络基础设施的关键部分，是最常见的节点类型。全节点存储区块链数据，并且通常参与常见的区块链操作，例如创作和验证区块、接收和验证交易以及响应用户请求提供数据。

![全节点](./assets/full-node.avif)

默认情况下，完整节点被配置为仅存储最近的 256 个块并丢弃比这更早的状态（创世块除外），以防止完整节点无限增长并消耗所有可用磁盘空间。您可以配置完整节点保留的块数。

尽管较旧的块被丢弃，但全节点保留从创世块到最新块的所有块头，以验证状态是否正确。因为全节点可以访问所有块头，所以它可以通过执行创世块中的所有块来重建整个区块链的状态。因此，它需要更多的计算来检索有关某些先前状态的信息，并且通常应该使用存档来代替。

全节点允许您读取链的当前状态并直接在网络上提交和验证交易。通过丢弃旧块的状态，完整节点比存档节点需要的磁盘空间少得多。然而，一个完整的节点需要更多的计算资源来查询和检索有关某些先前状态的信息。如果您需要查询历史区块，您应该清除整个节点，然后将其作为存档节点重新启动。

### 存档节点
存档节点类似于完整节点，不同之处在于它们存储所有过去的块，并且每个块都具有可用的完整状态。存档节点最常用于需要访问历史信息的实用程序，例如区块浏览器、钱包、论坛和类似应用程序。


![存档节点](./assets/archive-node.avif)
因为归档节点保留历史状态，所以它们需要大量磁盘空间。由于运行它们需要磁盘空间，归档节点不如完整节点常见。但是，归档节点可以方便地在任何时间点查询链的过去状态。例如，您可以查询存档节点以查找某个区块中的帐户余额或查看有关导致特定状态更改的交易的详细信息。当您在存档节点中的数据上运行这些类型的查询时，它们会更快、更高效。

### 轻客户端节点
轻客户端节点使您能够以最低的硬件要求连接到 Substrate 网络。


![Light client nodes](./assets/light-node.avif)

由于轻客户端节点需要最少的系统资源，它们可以嵌入到基于 Web 的应用程序、浏览器扩展、移动设备应用程序或物联网 (IoT) 设备中。轻客户端节点通过 RPC 端点提供运行时和对当前状态的访问。轻客户端节点的 RPC 端点可以用 Rust、JavaScript 或其他语言编写，用于读取块头、提交交易和查看交易结果。

轻客户端节点不参与区块链或网络操作。例如，轻客户端节点不负责区块创作或验证、八卦交易或达成共识。轻客户端节点不存储任何过去的块，因此如果不从拥有它的节点请求历史数据，它就无法读取历史数据。

## 节点角色
根据您在启动节点时指定的命令行选项，节点可以在链的进程中扮演不同的角色，并且可以提供对链上状态的不同级别的访问。例如，您可以限制有权创作新区块的节点以及哪些节点可以与对等方通信。未被授权作为区块生产者的对等节点可以导入新区块、接收交易以及向其他节点发送和接收关于新交易的八卦。还可以阻止节点连接到更广泛的网络并限制与特定节点通信。

## 下一步去哪里
您可以使用 Substrate 构建几乎任何类型的网络——从完全独立的私有单链到您自己的中继链生态系统或兼容的平行链。

要更深入地了解网络和节点类型，请探索以下主题。

- 构建本地区块链
- 模拟网络
- 添加可信节点
- 授权特定节点